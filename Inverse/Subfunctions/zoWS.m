function zos=zoWS(D,ustarc,ustarcrit,rhow)% zoWS- a program to calculate zos, the bed roughness parameter for mobile% 			  flat bed, using the formula from Wieberg and Rubin, 1989.%			  ws stands for "Wieberg and Smith"%%	Bruce Jaffe, USGS 3/13/01%%	function zo = zoWS(d,ustarc,ustarcrit,rhow)%%		Inputs: D- nominal grain diameter (m)%				ustarc- current shear velocity (m/s) (may be a vector)%				ustarcrit- critical shear velocity for initiation of motion (m/s) (may be a vector)%				rhow- density of water (kg/m3)%%		Used: gammawWS- a constant determined by Wieberg and Rubin to fit the data%			  taub- bottom shear stress (N/m2)%			  taucrit- critical shear stress for initiation of motion (N/m2)%			  Tstar- transport stage, ratio of taub to taucrit%			  delb- average saltation height%			  a1- constant used in fomulation of average saltation height%			  a2- constant used in fomulation of average saltation height%%		Output: zos- bed roughness for mobile flat bed (m)  *** must be added to zoN (Nikuradse%					 bed roughness) to get total roughness  (zo=zoN+zos)%%		Reference:  Wieberg, P. L. and Rubin, D. M., 1989, Bed roughness produced by%					saltating sediment. J. Geophys. Res., V. 94, no. C4, pp. 5011-5016.%%%  BEJ 3/13/01gammaWS = 0.056;a1=0.68;a2=0.0204*(log(D*100))^2+0.0220*log(D*100)+0.0709; 	% equation 6, D converted to cm, WIberg and Rubin, 1989taub=rhow*ustarc.^2;taucrit=rhow*ustarcrit.^2;Tstar=taub./taucrit;delb=D*a1*Tstar./(1+a2*Tstar);zos=gammaWS*delb;   % equation 7 WIberg and Rubin, 1989